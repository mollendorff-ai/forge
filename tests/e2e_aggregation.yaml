# E2E Aggregation Function Validation
# Validated against Gnumeric/LibreOffice Calc

_forge_version: "1.0.0"

assumptions:
  # SUM
  test_sum_basic:
    value: null
    formula: "=SUM(1, 2, 3, 4, 5)"         # Expected: 15
  test_sum_negative:
    value: null
    formula: "=SUM(10, -3, 5, -2)"         # Expected: 10
  test_sum_decimal:
    value: null
    formula: "=SUM(1.5, 2.5, 3.5)"         # Expected: 7.5

  # AVERAGE
  test_average_basic:
    value: null
    formula: "=AVERAGE(10, 20, 30)"        # Expected: 20
  test_average_decimal:
    value: null
    formula: "=AVERAGE(1, 2, 3, 4)"        # Expected: 2.5

  # COUNT
  test_count_numbers:
    value: null
    formula: "=COUNT(1, 2, 3, 4, 5)"       # Expected: 5
  test_count_mixed:
    value: null
    formula: "=COUNT(1, \"a\", 3, \"b\", 5)" # Expected: 3

  # COUNTA
  test_counta_all:
    value: null
    formula: "=COUNTA(1, \"a\", 3, \"b\", 5)" # Expected: 5

  # COUNTBLANK - tested via IS functions

  # MIN
  test_min_positive:
    value: null
    formula: "=MIN(5, 3, 8, 1, 9)"         # Expected: 1
  test_min_negative:
    value: null
    formula: "=MIN(-5, 3, -8, 1, -9)"      # Expected: -9
  test_min_decimal:
    value: null
    formula: "=MIN(1.5, 0.5, 2.5)"         # Expected: 0.5

  # MAX
  test_max_positive:
    value: null
    formula: "=MAX(5, 3, 8, 1, 9)"         # Expected: 9
  test_max_negative:
    value: null
    formula: "=MAX(-5, -3, -8, -1, -9)"    # Expected: -1
  test_max_decimal:
    value: null
    formula: "=MAX(1.5, 0.5, 2.5)"         # Expected: 2.5

  # PRODUCT
  test_product_basic:
    value: null
    formula: "=PRODUCT(2, 3, 4)"           # Expected: 24
  test_product_decimal:
    value: null
    formula: "=PRODUCT(1.5, 2, 3)"         # Expected: 9

  # SUMPRODUCT
  test_sumproduct_basic:
    value: null
    formula: "=SUMPRODUCT(1, 2, 3, 4, 5, 6)" # Expected: 1*4 + 2*5 + 3*6 = 32

  # SUMSQ
  test_sumsq_basic:
    value: null
    formula: "=SUMSQ(3, 4)"                # Expected: 25 (9 + 16)
  test_sumsq_multiple:
    value: null
    formula: "=SUMSQ(1, 2, 3)"             # Expected: 14 (1 + 4 + 9)

  # AVG (alias for AVERAGE)
  test_avg_basic:
    value: null
    formula: "=AVG(10, 20, 30)"            # Expected: 20
