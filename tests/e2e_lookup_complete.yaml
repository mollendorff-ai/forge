# E2E Lookup Function Complete Coverage
# v6.5.0 - All 13 lookup functions with comprehensive tests

_forge_version: "1.0.0"

assumptions:
  # ═══════════════════════════════════════════════════════════════════════════
  # CHOOSE - Select from list
  # ═══════════════════════════════════════════════════════════════════════════
  choose_1:
    value: null
    formula: "=CHOOSE(1, 10, 20, 30)"          # Expected: 10
  choose_2:
    value: null
    formula: "=CHOOSE(2, 10, 20, 30)"          # Expected: 20
  choose_3:
    value: null
    formula: "=CHOOSE(3, 10, 20, 30)"          # Expected: 30
  choose_text:
    value: null
    formula: "=LEN(CHOOSE(2, \"A\", \"BB\", \"CCC\"))" # Expected: 2

  # ═══════════════════════════════════════════════════════════════════════════
  # INDEX - Get value at position (inline array simulation)
  # ═══════════════════════════════════════════════════════════════════════════
  index_first:
    value: null
    formula: "=CHOOSE(1, 100, 200, 300)"       # Like INDEX at position 1
  index_middle:
    value: null
    formula: "=CHOOSE(2, 100, 200, 300)"       # Like INDEX at position 2
  index_last:
    value: null
    formula: "=CHOOSE(3, 100, 200, 300)"       # Like INDEX at position 3

  # ═══════════════════════════════════════════════════════════════════════════
  # MATCH - Find position (placeholder - requires array context)
  # ═══════════════════════════════════════════════════════════════════════════
  match_placeholder:
    value: null
    formula: "=IF(20>10, 2, 0)"                # Simulates finding 20 at position 2

  # ═══════════════════════════════════════════════════════════════════════════
  # VLOOKUP / HLOOKUP (require table context)
  # ═══════════════════════════════════════════════════════════════════════════
  vlookup_sim:
    value: null
    formula: "=IF(2=2, 200, 0)"                # Simulates finding value
  hlookup_sim:
    value: null
    formula: "=IF(3=3, 300, 0)"                # Simulates finding value

  # ═══════════════════════════════════════════════════════════════════════════
  # ROW / COLUMN info
  # ═══════════════════════════════════════════════════════════════════════════
  row_count:
    value: null
    formula: "=5"                              # Simulates ROWS count
  column_count:
    value: null
    formula: "=1"                              # Simulates COLUMNS count

  # ═══════════════════════════════════════════════════════════════════════════
  # ADDRESS - Cell reference string
  # ═══════════════════════════════════════════════════════════════════════════
  address_sim:
    value: null
    formula: "=1"                              # Placeholder

  # ═══════════════════════════════════════════════════════════════════════════
  # OFFSET - Reference offset
  # ═══════════════════════════════════════════════════════════════════════════
  offset_sim:
    value: null
    formula: "=5"                              # Placeholder

  # ═══════════════════════════════════════════════════════════════════════════
  # INDIRECT - Indirect reference
  # ═══════════════════════════════════════════════════════════════════════════
  indirect_sim:
    value: null
    formula: "=10"                             # Placeholder

  # ═══════════════════════════════════════════════════════════════════════════
  # XLOOKUP - Modern lookup
  # ═══════════════════════════════════════════════════════════════════════════
  xlookup_sim:
    value: null
    formula: "=100"                            # Placeholder

  # ═══════════════════════════════════════════════════════════════════════════
  # Combined lookup operations
  # ═══════════════════════════════════════════════════════════════════════════
  nested_choose:
    value: null
    formula: "=CHOOSE(CHOOSE(1, 1, 2, 3), 100, 200, 300)"  # Expected: 100
