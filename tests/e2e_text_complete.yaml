# E2E Text Function Complete Coverage
# v6.3.0 - All 15 text functions with comprehensive tests

_forge_version: "1.0.0"

assumptions:
  # ═══════════════════════════════════════════════════════════════════════════
  # LEN - String length
  # ═══════════════════════════════════════════════════════════════════════════
  len_basic:
    value: null
    formula: "=LEN(\"Hello\")"         # Expected: 5
  len_with_spaces:
    value: null
    formula: "=LEN(\"Hello World\")"   # Expected: 11
  len_empty:
    value: null
    formula: "=LEN(\"\")"              # Expected: 0

  # ═══════════════════════════════════════════════════════════════════════════
  # LEFT / RIGHT / MID - Substring extraction
  # ═══════════════════════════════════════════════════════════════════════════
  left_basic:
    value: null
    formula: "=LEN(LEFT(\"Hello World\", 5))"  # Expected: 5
  right_basic:
    value: null
    formula: "=LEN(RIGHT(\"Hello World\", 5))" # Expected: 5
  mid_basic:
    value: null
    formula: "=LEN(MID(\"Hello World\", 7, 5))" # Expected: 5

  # ═══════════════════════════════════════════════════════════════════════════
  # UPPER / LOWER - Case conversion
  # ═══════════════════════════════════════════════════════════════════════════
  upper_check:
    value: null
    formula: "=LEN(UPPER(\"hello\"))"  # Expected: 5
  lower_check:
    value: null
    formula: "=LEN(LOWER(\"HELLO\"))"  # Expected: 5

  # ═══════════════════════════════════════════════════════════════════════════
  # TRIM - Remove extra spaces
  # ═══════════════════════════════════════════════════════════════════════════
  trim_basic:
    value: null
    formula: "=LEN(TRIM(\"  Hello  \"))"  # Expected: 5

  # ═══════════════════════════════════════════════════════════════════════════
  # CONCAT / CONCATENATE - String joining
  # ═══════════════════════════════════════════════════════════════════════════
  concat_basic:
    value: null
    formula: "=LEN(CONCAT(\"Hello\", \" \", \"World\"))"  # Expected: 11
  concatenate_basic:
    value: null
    formula: "=LEN(CONCATENATE(\"A\", \"B\", \"C\"))"     # Expected: 3

  # ═══════════════════════════════════════════════════════════════════════════
  # FIND / SEARCH - Position finding
  # ═══════════════════════════════════════════════════════════════════════════
  find_basic:
    value: null
    formula: "=FIND(\"o\", \"Hello\")"      # Expected: 5
  search_basic:
    value: null
    formula: "=SEARCH(\"o\", \"Hello\")"    # Expected: 5

  # ═══════════════════════════════════════════════════════════════════════════
  # REPLACE / SUBSTITUTE - String replacement
  # ═══════════════════════════════════════════════════════════════════════════
  replace_basic:
    value: null
    formula: "=LEN(REPLACE(\"Hello\", 2, 2, \"XX\"))"  # Expected: 5
  substitute_basic:
    value: null
    formula: "=LEN(SUBSTITUTE(\"aaa\", \"a\", \"b\"))" # Expected: 3

  # ═══════════════════════════════════════════════════════════════════════════
  # VALUE - Text to number conversion
  # ═══════════════════════════════════════════════════════════════════════════
  value_integer:
    value: null
    formula: "=VALUE(\"123\")"            # Expected: 123
  value_decimal:
    value: null
    formula: "=VALUE(\"123.45\")"         # Expected: 123.45

  # ═══════════════════════════════════════════════════════════════════════════
  # TEXT - Number to formatted text
  # ═══════════════════════════════════════════════════════════════════════════
  text_number:
    value: null
    formula: "=LEN(TEXT(1234.5, \"0.00\"))"  # Expected: 7 (1234.50)
