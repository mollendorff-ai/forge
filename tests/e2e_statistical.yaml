# E2E Statistical Function Validation
# Validated against Gnumeric/LibreOffice Calc

_forge_version: "1.0.0"

assumptions:
  # MEDIAN
  test_median_odd:
    value: null
    formula: "=MEDIAN(1, 3, 5, 7, 9)"      # Expected: 5
  test_median_even:
    value: null
    formula: "=MEDIAN(1, 2, 3, 4)"         # Expected: 2.5
  test_median_unordered:
    value: null
    formula: "=MEDIAN(9, 1, 5, 3, 7)"      # Expected: 5

  # VAR (sample variance)
  test_var_sample:
    value: null
    formula: "=VAR(2, 4, 4, 4, 5, 5, 7, 9)" # Expected: 4.571...

  # VARP (population variance)
  test_varp_population:
    value: null
    formula: "=VARP(2, 4, 4, 4, 5, 5, 7, 9)" # Expected: 4

  # STDEV (sample standard deviation)
  test_stdev_sample:
    value: null
    formula: "=STDEV(2, 4, 4, 4, 5, 5, 7, 9)" # Expected: ~2.138

  # STDEVP (population standard deviation)
  test_stdevp_population:
    value: null
    formula: "=STDEVP(2, 4, 4, 4, 5, 5, 7, 9)" # Expected: 2

  # LARGE
  test_large_first:
    value: null
    formula: "=LARGE(3, 1, 4, 1, 5, 9, 2, 6, 1)"  # Expected: 9 (1st largest)
  test_large_third:
    value: null
    formula: "=LARGE(3, 1, 4, 1, 5, 9, 2, 6, 3)"  # Expected: 5 (3rd largest)

  # SMALL
  test_small_first:
    value: null
    formula: "=SMALL(3, 1, 4, 1, 5, 9, 2, 6, 1)"  # Expected: 1 (1st smallest)
  test_small_third:
    value: null
    formula: "=SMALL(3, 1, 4, 1, 5, 9, 2, 6, 3)"  # Expected: 2 (3rd smallest)

  # PERCENTILE
  test_percentile_50:
    value: null
    formula: "=PERCENTILE(1, 2, 3, 4, 5, 0.5)"    # Expected: 3 (50th percentile)
  test_percentile_25:
    value: null
    formula: "=PERCENTILE(1, 2, 3, 4, 5, 0.25)"   # Expected: 2 (25th percentile)

  # QUARTILE
  test_quartile_q1:
    value: null
    formula: "=QUARTILE(1, 2, 3, 4, 5, 1)"        # Expected: 2 (Q1)
  test_quartile_q2:
    value: null
    formula: "=QUARTILE(1, 2, 3, 4, 5, 2)"        # Expected: 3 (Q2/median)
  test_quartile_q3:
    value: null
    formula: "=QUARTILE(1, 2, 3, 4, 5, 3)"        # Expected: 4 (Q3)

  # RANK.EQ
  test_rank_first:
    value: null
    formula: "=RANK.EQ(9, 3, 1, 4, 1, 5, 9, 2, 6)" # Expected: 1 (9 is largest)
  test_rank_middle:
    value: null
    formula: "=RANK.EQ(4, 3, 1, 4, 1, 5, 9, 2, 6)" # Expected: 4
